/*
 JSKK v1.2.1 | (c) 2014 Timothy Chandler <tim@geomash.com> | http://github.com/melechi/JS-Klass-Kit/blob/master/LICENSE 
 Date Built: 2015-01-06
*/
Object.extend=function(a,b){if(Object.isAssocArray(b)){(null==a||Object.isUndefined(a))&&(a={});for(var c in b)Object.isNull(b[c])?a[c]=null:Object.isAssocArray(b[c])?(Object.isAssocArray(a[c])||(a[c]={}),a[c]=Object.extend(a[c],b[c])):a[c]=Object.isArray(b[c])?Object.extend(a[c],b[c]):b[c]}else if(Object.isArray(b)){Object.isArray(a)||(a=[]);for(var d=0,e=b.length;e>d;d++)a[d]=Object.extend(a[d],b[d])}else a=b;return a},Object.clone=function(a){var b={};return b=Object.extend(b,a)},Object.isUndefined=function(a){return"undefined"==typeof a},Object.isDefined=function(a){return"undefined"!=typeof a},Object.isFunction=function(a){return"function"==typeof a},Object.isString=function(a){return"string"==typeof a},Object.isNumber=function(a){return"number"==typeof a},Object.isNumeric=function(a){return null!==a&&"boolean"!=typeof a&&"[object Array]"!==Object.prototype.toString.call(a)&&!isNaN(Number(a))},Object.isElement=function(a){return a&&1==a.nodeType},Object.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},Object.isDate=function(a){return"[object Date]"===Object.prototype.toString.call(a)},Object.isNull=function(a){return null===a},Object.isAssocArray=function(a){return null===a?!1:"[object Object]"===Object.prototype.toString.call(a)},Object.isBoolean=function(a){return"boolean"==typeof a},Object.isEmpty=function(a,b){return!a||Object.isUndefined(a)||Object.isNull(a)||Object.isArray(a)&&0===a.length||Object.isString(a)&&(""===a.trim()||"0"===a)||Object.isNumber(a&&0===a)?!0:b&&/^(\t*)|(\v*)|(\s*)$/.test(a)?!0:!1},Object.toQueryString=function(a){if(this.isString(a))return a;var b="";for(var c in a)this.isFunction(a[c])||"object"==typeof a[c]||(b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c])+"&");return b},Object.toIndexedArray=function(a){var b=[];for(var c in a)b.push(a[c]);return b},Object.toArray=function(a){if(Object.isArray(a))return a;if(Object.isString(a))return a.split("");if(Object.isNumber(a))return[a];if(Object.isAssocArray(a)){var b=[];if(Object.isIndexed(a))for(item in a)Object.isNumber(item)&&(b[item]=a[item]);else{var c=-1;for(item in a)if(c++,Object.isNumber(item)&&Object.isDefined(b[c])){var d=c+1;b[d]=b[c],b[c]=a[item],c++}else b[c]=a[item]}return b}return[a]},Object.isIndexed=function(a){if(Object.isAssocArray(a)){var b=!1;for(var c in a)if(b=!0,!Object.isNumeric(c))return!1;return b}return!1},Object.ifSetOr=function(a,b){return Object.isDefined(a)?a:b||null},Object.isEqual=function(a,b){var c;if(typeof a!=typeof b)return!1;for(c in a)if("undefined"==typeof b[c])return!1;for(c in a)if(a[c])switch(typeof a[c]){case"object":if(!Object.isEqual(a[c],b[c]))return!1;break;case"function":if("undefined"==typeof b[c]||a[c].toString()!=b[c].toString())return!1;break;default:if(a[c]!=b[c])return!1}else if(b[c])return!1;for(c in b)if("undefined"==typeof a[c])return!1;return!0},define("extension/Object",[],function(){}),Object.extend(Function.prototype,{bind:function(){if(arguments.length<2&&"undefined"==typeof arguments[0])return this;var a=this,b=$JSKK.toArray(arguments),c=b.shift();return function(){return a.apply(c,b.concat($JSKK.toArray(arguments)))}},curry:function(){if(!arguments.length)return this;var a=this,b=$JSKK.toArray(arguments);return function(){return a.apply(this,b.concat($JSKK.toArray(arguments)))}},intercept:function(){if(!(arguments.length<1&&"function"!=typeof arguments[0])){var a=this,b=$JSKK.toArray(arguments),c=b.shift();return function(){return c.apply(this,b.concat($JSKK.toArray(arguments))),a.apply(this,b.concat($JSKK.toArray(arguments)))}}},join:function(){if(!(arguments.length<1&&"function"!=typeof arguments[0])){var a=this,b=$JSKK.toArray(arguments),c=b.shift();return function(){return a.apply(this,b.concat($JSKK.toArray(arguments))),c.apply(this,b.concat($JSKK.toArray(arguments)))}}},sequencedJoin:function(){if(!(arguments.length<1&&"function"!=typeof arguments[0])){var a=this,b=$JSKK.toArray(arguments),c=b.shift();return function(){var d=a.apply(this,b.concat($JSKK.toArray(arguments)));return Object.isNull(d)?null:Object.isAssocArray(d)&&Object.isDefined(d.args)?c.apply(this,d.args):c.call(this,d)}}},defer:function(){var a=this,b=$JSKK.toArray(arguments),c=b.shift(),d=b.shift(),e=b.shift();Object.isArray(e)||(e=[e]),window.setTimeout(function(){a.apply(d,e)},c)},delay:function(){arguments[0]=1e3*arguments[0],this.defer.apply(this,arguments)}}),define("extension/Function",[],function(){});var $break={};Object.extend(Array.prototype,{_each:function(a){for(var b=0,c=this.length;c>b;b++)a(this[b])},each:function(a){var b=0;try{this._each(function(c){a(c,b++)})}catch(c){if(c!=$break)throw c}return this},find:function(a){var b;return this.each(function(c,d){if(a(c,d))throw b=c,$break}),b},findAll:function(a){var b=[];return this.each(function(c,d){a(c,d)&&b.push(c)}),b},first:function(){return this[0]},last:function(){return this[this.length-1]},inArray:function(a){return void 0!=this.find(function(b){return a==b?!0:!1})?!0:!1},without:function(){if(Object.isArray(arguments[0])){var a=$JSKK.toArray(arguments[0]);return this.findAll(function(b){return!a.include(b)})}var a=$JSKK.toArray(arguments);return this.findAll(function(b){return!a.include(b)})},min:function(){return Math.min.apply(this,this)},max:function(){return Math.max.apply(this,this)},sum:function(){for(var a=0,b=0,c=this.length;c>b;b++)a+=Number(this[b]);return a},average:function(){return this.sum()/this.length}}),define("extension/Array",[],function(){}),Object.extend(String.prototype,{nl2br:function(){return this.replace(/[\r\n\f]/g,"<br />")},trim:function(){for(var a=this.replace(/^\s\s*/,""),b=/\s/,c=a.length;b.test(a.charAt(--c)););return a.slice(0,c+1)},toQueryParams:function(a){var b=this.trim().match(/([^?#]*)(#.*)?$/);return b?b[1].split(a||"&").inject({},function(a,b){if((b=b.split("="))[0]){var c=decodeURIComponent(b.shift()),d=b.length>1?b.join("="):b[0];Object.isUndefined(d)||(d=decodeURIComponent(d)),c in a?(Object.isArray(a[c])||(a[c]=[a[c]]),a[c].push(d)):a[c]=d}return a}):{}},ellipse:function(a){return this.length>a?this.substr(0,a-3)+"...":this},lowerFirst:function(){var a=this.substring(0,1),b=this.substring(1);return a.toLowerCase()+b}}),define("extension/String",[],function(){}),define("Core",["./extension/Object","./extension/Function","./extension/Array","./extension/String"],function(){var a={version:"1.1.0",emptyFunction:function(){},global:window||global||null,namespace:function(){function b(a,b){var d,e;if(Object.isString(a)){var f,g;if(!c.test(a))throw new Error('"'+a+'" is not a valid name for a package.');f=b,g=a.split(".");for(var d=0,e=g.length;e>d;d++)a=g[d],f[a]=f[a]||{},f=f[a];return f}throw console.trace(),new TypeError}var c=/^(?:[\$a-zA-Z_]\w*[.])*[\$a-zA-Z_]\w*$/;return function(c,d){return b(c,d||a.global)}}(),usingPackage:function(){var a=arguments;return function(b){return b.apply(a[0],a)}},toArray:function(a){if(!a)return[];if(("function"!=typeof a||"[object NodeList]"!=a)&&a.toArray)return a.toArray();for(var b=a.length||0,c=new Array(b);b--;)c[b]=a[b];return c},strToObject:function(b){for(var c=a.global,d=b.split("."),e=0,f=d.length;f>e;e++){if(!Object.isDefined(c[d[e]]))throw new Error('Invalid string to object. Object "'+b+'" has not been loaded.');c=c[d[e]]}return c},require:function(b,c){if(Object.isDefined(b)){var d=[];Object.isArray(b)||(b=[b]);for(var e=0,f=b.length;f>e;e++){if(!Object.isString(b[e]))throw new Error('Object literal "'+b[e]+'" used in require. Only use strings.');try{a.strToObject(b[e])}catch(g){d.push(b[e].replace(/\./g,"/"))}}var h=function(b){for(var d=0,e=b.length;e>d;d++)try{var f=a.strToObject(b[d]);if(Object.isUndefined(f.prototype.$reflect))return void window.setTimeout(h,50)}catch(g){return void window.setTimeout(h,50)}c()}.bind(this,b);d.length?requirejs(d,h):c()}}};return Object.isDefined(window)?a.global.$JSKK=a:exports.$JSKK=a,Object.isUndefined(a.global.console)?a.global.console={log:a.emptyFunction,debug:a.emptyFunction,warn:a.emptyFunction,info:a.emptyFunction,trace:a.emptyFunction}:Object.isUndefined(a.global.console.debug)&&(a.global.console.debug=a.global.console.log),a}),define("Interface",["./Core"],function(){return $JSKK.Interface={create:function(a){if(Object.isString(a)){var b=window,c=a,d={};d.$name=a,d.$namespace="window",a=d}else{if(Object.isUndefined(a.$name))throw Error("Interface name must be defined.");var c=a.$name;if(Object.isUndefined(a.$namespace)){a.$namespace="window";var b=window}else var b=$JSKK.namespace(a.$namespace)}if(b[c]=function(){throw['Interface "'+c+'" cannot be initiated because interfaces'," are abstract classes which cannot be directly initiated."].join("")},b[c].toString=function(){return"[JSKK Interface ("+a.$namespace+"."+a.$name+")]"},a.$type="interface",Object.isDefined(a.$extends))if(Object.isString(a.$extends)){for(var e=$JSKK.global,f=a.$extends.split("."),g=0,h=f.length;h>g;g++){if(!Object.isDefined(e[f[g]]))throw new Error('Invalid extension. Class "'+a.$extends+'" has not been loaded.');e=e[f[g]]}a.$extends=e}else console.warn("Using object literals is deprecated as of JSKK v1.1 and will be disabled in v1.2. Please use strings instead.");return b[c].prototype.$reflect=function(b){switch(b){case"type":return a.$type;case"namespace":return a.$namespace;case"name":return a.$name;case"fullname":return this.$namespace+"."+this.$name;case"extends":return a.$extends;case"implements":return a.$implements;default:return{type:a.$type,namespace:a.$namespace,name:a.$name,fullname:this.$namespace+"."+this.$name,"extends":a.$extends,"implements":a.$implements}}},function(d){if(!Object.isUndefined(a.$extends)){if("trait"==a.$extends.definition.$type)throw new Error("Interfaces cannot extend Traits.");if("class"==a.$extends.definition.$type)throw new Error("Interfaces cannot extend Classes.");b[c].prototype=Object.extend(b[c].prototype,a.$extends.prototype)}if(!Object.isUndefined(a.$implements))throw new Error("Interfaces cannot implement other Interfaces. Interfaces can only extend other Interfaces.");for(var e in d){if(Object.isFunction(d[e])&&d[e]!=$JSKK.Interface.METHOD)throw new Error("Interfaces may only contain empty functions. Use $JSKK.Interface.METHOD.");b[c].prototype[e]=d[e]}}},PROPERTY:function(){},METHOD:function(){},validate:function(a){if(Object.isUndefined(a))throw new Error("Unable to implement interface. Interface to implement is undefined.");if("class"==a.$type)throw new Error(['Unable to implement interface. Interface to implement is a "$JSKK.Class".',' An interface must be a "$JSKK.Interface".']);if("trait"==a.$type)throw new Error(['Unable to implement interface. Interface to implement is a "$JSKK.Trait".',' An interface must be a "$JSKK.Interface".']);return!0},add:function(a,b,c,d){for(var e in d.prototype)if("interfaceName"!=e){if(d.prototype[e]==$JSKK.Interface.METHOD&&!(Object.isFunction(b[e])||c&&Object.isFunction(c.prototype[e])))throw new Error(['The implementation of interface "'+d.prototype.interfaceName+'" requires',' the method "'+e+'" be implemented.'].join(""));a.prototype[e]=Object.isAssocArray(d.prototype[e])?Object.clone(d.prototype[e]):d.prototype[e]}}},$JSKK.Interface}),define("Trait",["./Core"],function(){return $JSKK.Trait={create:function(a){if("string"==typeof a){var b=window,c=a,d={};d.$name=a,d.$namespace="window",a=d}else{if("undefined"==typeof a.$name)throw Error("Trait name must be defined.");var c=a.$name;if("undefined"==typeof a.$namespace){a.$namespace="window";var b=window}else var b=$JSKK.namespace(a.$namespace)}return b[c]=function(){throw['Trait "'+c+'" cannot be initiated because traits'," are abstract classes which cannot be directly initiated."].join("")},b[c].toString=function(){return"[JSKK Trait ("+a.$namespace+"."+a.$name+")]"},a.$type="trait",b[c].prototype.$reflect=function(b){switch(b){case"type":return a.$type;case"namespace":return a.$namespace;case"name":return a.$name;case"fullname":return this.$namespace+"."+this.$name;case"implements":return a.$implements||[];case"uses":return a.$uses||[];default:return{type:a.$type,namespace:a.$namespace,name:a.$name,fullname:this.$namespace+"."+this.$name,"implements":a.$implements||[],uses:a.$uses||[]}}},function(d){var e=!1;if(Object.isUndefined(a.$uses)||(Object.isArray(a.$uses)||(a.$uses=[a.$uses]),e=$JSKK.Trait.normalize(a.$uses,!0)),!Object.isUndefined(a.$implements)){Object.isArray(a.$implements)||(a.$implements=[a.$implements]);for(var f=0,g=a.$implements.length;g>f;f++)$JSKK.Interface.validate(a.$implements[f])&&$JSKK.Interface.add(b[c],d,e,a.$implements[f])}Object.isUndefined(a.$uses)||$JSKK.Trait.validate(e)&&$JSKK.Trait.add(b[c],e);for(var h in d){if("function"!=typeof d[h])throw new Error("A trait may only contain methods.");b[c].prototype[h]=d[h]}}},normalize:function(a,b){Object.isArray(a)||(a=[a]);var c={};Object.isFunction(a[a.length-1])||Object.isString(a[a.length-1])||(c=a[a.length-1],delete a[a.length-1]);var d=function(){},e=[],f=[];d.prototype.traitName="Normalized";for(var g=0,h=a.length;h>g;g++)if(Object.isDefined(a[g])&&(Object.isString(a[g])?a[g]=$JSKK.strToObject(a[g]):console.warn("Using object literals is deprecated as of JSKK v1.1 and will be disabled in v1.2. Please use strings instead.")),Object.isFunction(a[g]))for(var i in a[g].prototype)Object.isFunction(a[g].prototype[i])&&("init"!=i||b)&&(e.inArray(i)?f.inArray(i)||(Object.isUndefined(c[i])?delete d.prototype[i]:d.prototype[i]=c[i].prototype[i],f.push(i)):(e.push(i),d.prototype[i]=a[g].prototype[i]));return d},validate:function(a){if(Object.isUndefined(a))throw new Error("Unable to add trait. Trait to add is undefined.");if(!Object.isUndefined(a.prototype.className))throw new Error(['Unable to add trait. Trait to add is an instance of "$JSKK.Class".',' A trait must be an instance of "$JSKK.Trait".']);if(!Object.isUndefined(a.prototype.instanceName))throw new Error(['Unable to add trait. Trait to add is an instance of "$JSKK.Interface".',' A trait must be an instance of "$JSKK.Trait".']);if(Object.isUndefined(a.prototype.traitName))throw new Error('Unable to add trait. Trait to add is not an instance of "$JSKK.Trait".');return!0},add:function(a,b){for(var c in b.prototype)if("traitName"!=c){if(!Object.isFunction(b.prototype[c]))throw new Error(["Attempt to add trait to class instance failed because trait contained an entity that was not a method."," Traits may only contain methods."].join(""));a.prototype[c]=b.prototype[c]}}},$JSKK.Trait}),define("Class",["./Core"],function(){return $JSKK.Class={create:function(a){var b={};if("string"==typeof a){var c=$JSKK.global,d=a;b.$name=a,b.$namespace=window?"window":"global",a=b}else{if(Object.isUndefined(a.$name))throw Error("Class name must be defined.");var d=a.$name;if(Object.isUndefined(a.$namespace)){b.$namespace=window?"window":"global";var c=$JSKK.global}else var c=$JSKK.namespace(a.$namespace)}return a.$type="class",c[d]=function(){var b=function(a,b){var c=function(a,b,d,e,f){var g=a[b].$parent;a[b].$parent=function(a,d){return function(){var f=null;if(!Object.isUndefined(e.definition.$extends))for(var g=e.definition.$extends,h=!1;;){if(Object.isFunction(g.prototype[b])&&a[b]!==g.prototype[b]){h=!0,f=c(a,b,d,g,arguments);break}if(Object.isUndefined(g.definition.$extends))break;g=g.definition.$extends}return h||(f=d.apply(a,arguments)),f}}(a,e.prototype[b]);var h=d.apply(a,f);return a[b].$parent=g,h},d=function(a,b,d){var e=a[b];a[b]=function(){return a[b].$parent=function(a,e){return function(){var f=null;if(!Object.isUndefined(d.definition.$extends))for(var g=d.definition.$extends,h=!1;;){if(Object.isFunction(g.prototype[b])&&a[b]!==g.prototype[b]){h=!0,f=c(a,b,e,g,arguments);break}if(Object.isUndefined(g.definition.$extends))break;g=g.definition.$extends}return h||(f=e.apply(a,arguments)),f}}(a,d.prototype[b]),e.apply(a,arguments)}};if(!Object.isUndefined(b.$extends))for(object in b.$extends.prototype)if(Object.isFunction(a[object])&&Object.isFunction(b.$extends.prototype[object])&&a[object]!==b.$extends.prototype[object])d(a,object,b.$extends);else if(Object.isFunction(a[object]))for(var e=b.$extends;;){if(Object.isFunction(e.prototype[object])&&a[object]!==e.prototype[object]){d(a,object,e);break}if(Object.isUndefined(e.definition.$extends))break;e=e.definition.$extends}},e=function(f){if(Object.isUndefined(c[d].definition))window.setTimeout(e,200);else{if(a.$abstract)throw'"'+d+'" is an abstract class and cannot be directly initiated.';var g=Object.clone(c[d].prototype);if(Object.isDefined(c[d].prototype.__behaviors)&&c[d].prototype.__behaviors.length)for(var h=0,i=c[d].prototype.__behaviors.length;i>h;h++){var j=f.shift();c[d].prototype.__behaviors[h].call(this,j)}c[d].prototype=g,Object.isUndefined(c[d].definition.$extends)||b(this,c[d].definition),Object.isFunction(this.init)&&this.init.apply(this,f)}}.bind(this,$JSKK.toArray(arguments));e()},function(b,e){var f=function(a,b,c){if(Object.isDefined(this.$extends)){if(Object.isUndefined(this.$extends.definition))return void window.setTimeout(f.bind(this,a,b,c),200);if("interface"==this.$extends.definition.$type)throw new Error("Unable to extend class from interface. Use $implements followed by interface.");if("trait"==this.$extends.definition.$type)throw new Error("Unable to extend class from trait. Use $uses followed by the trait or an array of traits.");if(!Object.isFunction(this.$extends.prototype.$reflect))throw new Error('Unable to extend class. Class to extend from is not an instance of "$JSKK.Class".');if(Object.isDefined(this.$extends.definition.$final)&&this.$extends.definition.$final)throw new Error("Unable to extend class. Class to extend from is declared as final.");for(var e in this.$extends)(this.$extends.definition.$statics.methods.inArray(e)||this.$extends.definition.$statics.properties.inArray(e))&&(a[d][e]=this.$extends[e]);this.$statics=Object.extend(this.$statics,this.$extends.definition.$statics),a[d].prototype=Object.extend(a[d].prototype,this.$extends.prototype)}Object.isUndefined(a[d].prototype)&&(a[d].prototype={});var g=!1;if(Object.isArray(a[d].prototype.__behaviors)||(a[d].prototype.__behaviors=[]),!Object.isUndefined(this.$uses)){g=$JSKK.Trait.normalize(this.$uses);for(var h=0,i=this.$uses.length;i>h;h++)Object.isFunction(this.$uses[h])&&Object.isFunction(this.$uses[h].prototype.init)&&a[d].prototype.__behaviors.push(this.$uses[h].prototype.init);Object.isArray(this.$uses)||(this.$uses=[this.$uses])}if(!Object.isUndefined(this.$implements)){Object.isArray(this.$implements)||(this.$implements=[this.$implements]);for(var h=0,i=this.$implements.length;i>h;h++)Object.isDefined(this.$implements[h])&&(Object.isString(this.$implements[h])?this.$implements[h]=$JSKK.strToObject(this.$implements[h]):console.warn("Using object literals is deprecated as of JSKK v1.1 and will be disabled in v1.2. Please use strings instead.")),$JSKK.Interface.validate(this.$implements[h])&&$JSKK.Interface.add(a[d],c,g,this.$implements[h])}Object.isUndefined(this.$uses)||$JSKK.Trait.validate(g)&&$JSKK.Trait.add(a[d],g),a[d].prototype.$reflect=function(b){var c=this,e=function(){for(var a=[],b=c.$extends;b;)a.push(b),b=b.definition.$extends;return a},f=function(){var a=[],b=c.$extends,d=null,e=null;if(Object.isArray(c.$uses))for(d=0,e=c.$uses.length;e>d;d++)a.push(c.$uses[d]);for(;b;){if(Object.isArray(b.definition.$uses))for(d=0,e=b.definition.$uses.length;e>d;d++)a.push(b.definition.$uses[d]);b=b.definition.$extends}return a},g=function(){var a=[],b=c.$extends,d=null,e=null;if(Object.isArray(c.$implements))for(d=0,e=c.$implements.length;e>d;d++)a.push(c.$implements[d]);for(;b;){if(Object.isArray(b.definition.$implements))for(d=0,e=b.definition.$implements.length;e>d;d++)a.push(b.definition.$implements[d]);b=b.definition.$extends}return a},h=function(){var a=[],b=c.$extends,d=null,e=null;if(Object.isArray(c.$requires))for(d=0,e=c.$requires.length;e>d;d++)a.push(c.$requires[d]);for(;b;){if(Object.isArray(b.definition.$requires))for(d=0,e=b.definition.$requires.length;e>d;d++)a.push(b.definition.$requires[d]);b=b.definition.$extends}return a};switch(b){case"type":return this.$type;case"namespace":return this.$namespace;case"name":return this.$name;case"fullname":return this.$namespace+"."+this.$name;case"extends":return e();case"implements":return g();case"uses":return f();case"abstract":return this.$abstract||!1;case"final":return this.$final||!1;case"requires":return h();case"self":return a[d];default:return{type:this.$type,namespace:this.$namespace,name:this.$name,fullname:this.$namespace+"."+this.$name,"extends":e(),"implements":g(),uses:f(),"abstract":this.$abstract||!1,"final":this.$final||!1,requires:h(),self:a[d]}}}.bind(this),Object.isUndefined(this.$statics)&&(this.$statics={properties:[],methods:[]});for(var j in b)Object.isFunction(b[j])?this.$statics.methods.push(j):this.$statics.properties.push(j),a[d][j]=Object.clone(b[j]);for(var j in c)if(Object.isFunction(c[j])){if(c[j]===$JSKK.Class.ABSTRACT_METHOD){if(!this.$abstract)throw'"'+d+'" contains one or more abstract methods and must be declared as abstract.';a[d].prototype[j]=Object.clone(c[j])}if(Object.isFunction(a[d].prototype[j])){var k=a[d].prototype[j];a[d].prototype[j]=c[j],a[d].prototype[j].$parent=k}else a[d].prototype[j]=Object.isAssocArray(c[j])?Object.clone(c[j]):c[j]}else a[d].prototype[j]=Object.isAssocArray(c[j])?Object.clone(c[j]):c[j];for(j in a[d].prototype)if(Object.isFunction(a[d].prototype[j])&&a[d].prototype[j]===$JSKK.Class.ABSTRACT_METHOD&&!this.$abstract)throw['"'+j+'" is an abstract method and so must either be defined or the class ',' "'+d+'" must be declared as abstract by defining'," $abstract:true in the class definition."].join("");a[d].toString=function(){return"[JSKK Class ("+this.$namespace+"."+this.$name+")]"}.bind(this),a[d].definition=this};Object.isArray(a.$requires)||(a.$requires=Object.isDefined(a.$requires)?[a.$requires]:[]);var g=function(){Object.isDefined(a.$requires)||(a.$requires=[]),Object.isDefined(a.$extends)&&(Object.isString(a.$extends)?a.$extends=$JSKK.strToObject(a.$extends):console.warn("The use of object literals is deprecated in JSKK 1.1. Use strings instead.")),Object.isDefined(a.$uses)&&(Object.isArray(a.$uses)||(a.$uses=[a.$uses]),a.$requires=a.$requires.concat(a.$uses)),Object.isDefined(a.$implements)&&(Object.isArray(a.$implements)||(a.$implements=[a.$implements]),a.$requires=a.$requires.concat(a.$uses)),a.$requires.length?$JSKK.require(a.$requires,f.bind(a,c,b,e)):f.bind(a)(c,b,e)}.bind(this);Object.isDefined(a.$extends)?$JSKK.require([a.$extends],g):g()}},ABSTRACT_METHOD:function(){}},$JSKK.Class}),define("When",["./Core"],function(){$JSKK.Class.create({$namespace:"$JSKK",$name:"When_"})({},{timer:null,items:{length:0},init:function(){this.timer=null,this.startTimer()},startTimer:function(){Object.isNull(this.timer)&&(this.timer=window.setInterval(function(){for(var a in this.items)if("length"!=a)try{this[this.items[a].condition](this.items[a])}catch(b){throw this.removeItem(this.items[a].id),b}}.bind(this),100))},stopTimer:function(){window.clearInterval(this.timer),this.timer=null},captureCondition:function(a,b,c){var c=$JSKK.toArray(c);c.length?(this.items[b].condition=a,this.items[b].callback=c.shift(),this.items[b].args=c):this.removeItem(b)},addItem:function(a,b){var c=Math.round(1e6*Math.random());return this.items[c]={id:c,scope:a,object:b,condition:null,callback:$JSKK.emptyFunction,args:null},this.items.length++,this.items.length&&this.startTimer(),c},removeItem:function(a){delete this.items[a],this.items.length--,this.items.length||this.stopTimer()},assert:function(a,b){a&&(b.callback.apply(b.callback,b.args),this.removeItem(b.id))},isDefined:function(a){this.assert(Object.isDefined(a.scope[a.object]),a)},isUndefined:function(a){this.assert(Object.isUndefined(a.scope[a.object]),a)},isTrue:function(a){Object.isFunction(a.scope)?this.assert(a.scope()===!0,a):this.assert(a.scope[a.object]===!0,a)},isFalse:function(a){Object.isFunction(a.scope)?this.assert(a.scope()===!1,a):this.assert(a.scope[a.object]===!1,a)},isBoolean:function(a){this.assert(Object.isBoolean(a.scope[a.object]),a)},isFunction:function(a){this.assert(Object.isFunction(a.scope[a.object]),a)},isArray:function(a){this.assert(Object.isArray(a.scope[a.object]),a)},isAssocArray:function(a){this.assert(Object.isAssocArray(a.scope[a.object]),a)},isString:function(a){this.assert(Object.isString(a.scope[a.object]),a)},isNumber:function(a){this.assert(Object.isNumber(a.scope[a.object]),a)},isElement:function(a){this.assert(Object.isElement(a.scope[a.object]),a)},isNull:function(a){this.assert(Object.isNull(a.scope[a.object]),a)},isEqualTo:function(a){this.assert(a.scope[a.object.object]==a.object.value,a)},isNotEqualTo:function(a){this.assert(a.scope[a.object.object]!=a.object.value,a)}}),$JSKK.When=new $JSKK.When_,$JSKK.when=function(a,b){var c=$JSKK.When.addItem(a,b),d=arguments.callee,e={andWhen:function(){return arguments.length?d(arguments[0],arguments[1]):d(a,b)}};return{isDefined:function(){return $JSKK.When.captureCondition("isDefined",c,arguments),e},isUndefined:function(){return $JSKK.When.captureCondition("isUndefined",c,arguments),e},isTrue:function(){return $JSKK.When.captureCondition("isTrue",c,arguments),e},isFalse:function(){return $JSKK.When.captureCondition("isFalse",c,arguments),e},isBoolean:function(){return $JSKK.When.captureCondition("isBoolean",c,arguments),e},isFunction:function(){return $JSKK.When.captureCondition("isFunction",c,arguments),e},isArray:function(){return $JSKK.When.captureCondition("isArray",c,arguments),e},isAssocArray:function(){return $JSKK.When.captureCondition("isAssocArray",c,arguments),e},isString:function(){return $JSKK.When.captureCondition("isString",c,arguments),e},isNumber:function(){return $JSKK.When.captureCondition("isNumber",c,arguments),e},isElement:function(){return $JSKK.When.captureCondition("isElement",c,arguments),e},isNull:function(){return $JSKK.When.captureCondition("isNull",c,arguments),e},isEqualTo:function(){return $JSKK.When.captureCondition("isEqualTo",c,arguments),e},isNotEqualTo:function(){return $JSKK.When.captureCondition("isNotEqualTo",c,arguments),e}}}}),function(a){define("iface/Configurable",["Core"],function(){return function(){$JSKK.Interface.create({$namespace:"$JSKK.iface",$name:"Configurable"})({config:{}})}.apply(a,arguments)})}(this),function(a){define("iface/Observable",["Core"],function(){return function(){$JSKK.Interface.create({$namespace:"$JSKK.iface",$name:"Observable"})({events:[],observe:$JSKK.Interface.METHOD,unobserve:$JSKK.Interface.METHOD,fireEvent:$JSKK.Interface.METHOD})}.apply(a,arguments)})}(this),function(a){define("trait/Configurable",["Core"],function(){return function(){$JSKK.Trait.create({$namespace:"$JSKK.trait",$name:"Configurable",$implements:"$JSKK.iface.Configurable"})({init:function(a){Object.extend(this.config,a)}})}.apply(a,arguments)})}(this),function(a){define("trait/Observable",["Core"],function(){return function(){$JSKK.Trait.create({$namespace:"$JSKK.trait",$name:"Observable",$implements:"$JSKK.iface.Observable"})({init:function(a){for(var b in a)if(!Object.isFunction(a[b])&&Object.isAssocArray(a[b])){if(!Object.isDefined(a[b].callback))throw new Error('Invalid observer. Observers defined as objects must specify "callback" as the callback function.');Object.isDefined(a[b].times)?this.observeTimes(a[b].times,b,a[b]):this.observe(b,a[b])}else{if(!Object.isFunction(a[b]))throw new Error("Invalid observer. Observers can only be functions.");this.observe(b,a[b])}},observe:function(a,b){Object.isArray(this.events[a])||(this.events[a]=[]),Object.isArray(a)||(a=[a]);for(var c=0,d=a.length;d>c;c++)this.events[a[c]].push(b),this.events[a[c]].last().times=0;return this},observeOnce:function(a,b){return this.observeTimes.call(this,1,a,b)},observeTimes:function(a,b,c){Object.isArray(this.events[b])||(this.events[b]=[]),Object.isArray(b)||(b=[b]);for(var d=0,e=b.length;e>d;d++)this.events[b[d]].push(c),this.events[b[d]].last().times=a;return this},unobserve:function(a,b){Object.isArray(a)||(a=[a]);for(var c=0,d=a.length;d>c;c++){if(!Object.isUndefined(this.events[a[c]]))for(var e=[],f=0,g=this.events[a[c]].length;g>f;f++)this.events[a[c]][f]==b?delete this.events[a[c]][f]:e.push(this.events[a[c]][f]);this.events[a[c]]=e,this.events[a[c]].length||(this.events[a[c]]=!0)}return this},fireEvent:function(){var a=$JSKK.toArray(arguments),b=a.shift();Object.isArray(b)||(b=[b]);for(var c=0,d=b.length;d>c;c++)if(!Object.isUndefined(this.events[b[c]])&&Object.isArray(this.events[b[c]]))for(var e=0,f=this.events[b[c]].length;f>e;e++)if(Object.isFunction(this.events[b[c]][e])){if(this.events[b[c]][e].apply(this,a)===!1)return!1;Object.isDefined(this.events[b[c]][e])&&0!==this.events[b[c]][e].times&&0===--this.events[b[c]][e].times&&this.unobserve(b[c],this.events[b[c]][e])}return!0},clearEvent:function(a){return Object.isUndefined(this.events[a])||(this.events[a]=!0),this}})}.apply(a,arguments)})}(this),function(a){define("trait/Timeable",["Core"],function(){return function(){$JSKK.Trait.create({$namespace:"$JSKK.trait",$name:"Timeable",$uses:"$JSKK.trait.Observable"})({startTimer:function(){this.config.timeout&&(this.timeout=this.config.timeout,window.clearInterval(this.timer),this.timer=window.setInterval(function(){this.timeout--,this.fireEvent("onTimerInterval",this,this.getElapsedTime()),this.timeout<=0&&(window.clearInterval(this.timer),this.fireEvent("onTimeout",this))}.bind(this),1e3))},restartTimer:function(){this.startTimer()},pauseTimer:function(){window.clearInterval(this.timer)},resumeTimer:function(){this.startTimer()},stopTimer:function(){window.clearInterval(this.timer),this.timeout=this.config.timeout},resetTimer:function(){this.timeout=this.config.timeout},getElapsedTime:function(){return this.config.timeout-this.timeout},getRemainingTime:function(){return this.timeout}})}.apply(a,arguments)})}(this),define("JSKK",["./Core","./Interface","./Trait","./Class","./When","./iface/Configurable","./iface/Observable","./trait/Configurable","./trait/Observable","./trait/Timeable"]);